<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Moileon Quiz</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- Home Section -->
    <section id="home" class="section active">
        <h1>Welcome to Moileon Quiz</h1>

        <!-- Lotus Image Section -->
        <div class="lotus-image" id="lotus-container">
            <img id="lotus" src="" alt="Lotus" style="width:200px; height:auto; display:block; margin:0 auto;">
            <div id="lotus-status" style="text-align:center; color:#666; padding:10px; font-size:12px;">
                Loading lotus image...
            </div>
        </div>

        <button onclick="showSection('quiz')">Start Quiz</button>
    </section>

    <!-- Quiz Section -->
    <section id="quiz" class="section">
        <h2>Quiz Time!</h2>
        <div id="quiz-container"></div>
        <button onclick="showSection('home')">Back to Home</button>
    </section>

    <script src="quest.js"></script>

    <script>
    function showSection(sectionId) {
        document.querySelectorAll('.section').forEach(section => {
            section.classList.remove('active');
        });
        document.getElementById(sectionId).classList.add('active');
    }

    function loadLotusImage() {
        const lotusImage = document.getElementById("lotus");
        const statusText = document.getElementById("lotus-status");

        const imageUrl = "https://moileon.in/assets/images/lotus.png";

        // If cached in localStorage, load instantly
        const cachedImage = localStorage.getItem("lotusImageData");
        if (cachedImage) {
            lotusImage.src = cachedImage;
            statusText.textContent = "";
            console.log("Loaded lotus image from cache.");
        }

        // Always try to fetch the latest from server
        fetch(imageUrl, { cache: "force-cache" })
            .then(response => {
                if (!response.ok) throw new Error("Network error");
                return response.blob();
            })
            .then(blob => {
                const objectURL = URL.createObjectURL(blob);
                lotusImage.src = objectURL;
                statusText.textContent = "";

                // Store in localStorage for instant future loads
                const reader = new FileReader();
                reader.onloadend = function () {
                    localStorage.setItem("lotusImageData", reader.result);
                };
                reader.readAsDataURL(blob);

                console.log("Lotus image loaded and cached.");
            })
            .catch(() => {
                if (!cachedImage) {
                    statusText.textContent = "Lotus image not available";
                }
                console.error("Failed to load lotus image from server.");
            });
    }

    document.addEventListener('DOMContentLoaded', function() {
        showSection('home');
        loadLotusImage();
    });
    </script>

</body>
</html>
