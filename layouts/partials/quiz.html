<div class="quiz-section" style="text-align: center;">
    <h1 class="quiz-title">Quest On!</h1>
    <div class="score">Score: <span id="score-display">0</span></div>
    <div class="question" id="question-display">Loading question...</div>
    
    <input type="text" class="answer-input" id="answer-input" placeholder="Type your answer here">
    <div class="instruction">Press Enter after typing your answer</div>
    
    <div class="quiz-buttons">
        <button class="button submit-btn">Submit Answer</button>
        <button class="button next-btn">Show me the answer</button>
    </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {
    // Built-in quiz questions
    const questions = [
        {
    "question": "Which companyâ€™s first product was a line of playing cards in 1889?",
    "answer": ["nintendo", "Nintendo"],
    "explanation": "Nintendo started as a playing card company in Kyoto, Japan, founded by Fusajiro Yamauchi."
  },
  {
    "question": "Which was the first product to be scanned with a barcode?",
    "answer": ["wigley's chewing gum", "Wrigley's Chewing Gum"] 
  },
  {
    "question": "Diamond is the hardest mineral on the Mohs Hardness scale. Which mineral, once commonly used in households, is the softest?",
    "answer": ["talc", "Talc"]
  },
  {
    "question": "A kind of cognitive bias where a person overvalues something they helped create. The idea being that 'labour alone can be sufficient to induce greater liking for the fruits of one's labour'. How is this cognitive bias better known as?",
    "answer": ["ikea effect", "IKEA Effect"]
  },
  {
    "question": "It began as an attempt at creating textured wallpaper. But when Alfred Fielding and Marc Chavannes put two pieces of plastic shower curtains through a heat-sealing machine, the product was something peculiar. Which accidental invention, that helped IBM bring its computers to customers, soon revolutionised the packaging industry?",
    "answer": ["bubble wrap", "Bubble Wrap"]
  },
    ];

    let currentQuestionIndex = 0;
    let score = 0;
    let shuffledQuestions = [];

    const questionElement = document.getElementById("question-display");
    const answerInput = document.getElementById("answer-input");
    const submitButton = document.querySelector(".submit-btn");
    const nextButton = document.querySelector(".next-btn");
    const scoreElement = document.getElementById("score-display");

    // Only initialize if all elements exist
    if (!questionElement || !answerInput || !submitButton || !scoreElement) {
        return;
    }

    // Initialize quiz
    shuffledQuestions = shuffleArray([...questions]);
    showQuestion();

    function shuffleArray(array) {
        const shuffled = [...array];
        for (let i = shuffled.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
        }
        return shuffled;
    }

    function showQuestion() {
        if (currentQuestionIndex >= shuffledQuestions.length) {
            finishQuiz();
            return;
        }

        const currentQuestion = shuffledQuestions[currentQuestionIndex];
        questionElement.textContent = currentQuestion.question;
        answerInput.value = "";
        answerInput.disabled = false;
        answerInput.focus();

        submitButton.textContent = "Submit Answer";
        submitButton.disabled = false;
        nextButton.textContent = "Show me the answer";
        nextButton.disabled = false;
    }

    function getCorrectAnswers(question) {
        if (Array.isArray(question.answer)) {
            return question.answer;
        } else if (typeof question.answer === 'string') {
            return [question.answer];
        }
        return ["unknown"];
    }

    function getDisplayAnswer(question) {
        const answers = getCorrectAnswers(question);
        return answers[0];
    }

    function checkAnswer() {
        const userAnswer = answerInput.value.trim().toLowerCase();
        if (!userAnswer) return;

        const currentQuestion = shuffledQuestions[currentQuestionIndex];
        const correctAnswers = getCorrectAnswers(currentQuestion).map(ans => ans.toLowerCase());
        const isCorrect = correctAnswers.some(answer => userAnswer === answer);

        if (isCorrect) {
            score++;
            scoreElement.textContent = score;
            let message = "Correct!";
            if (currentQuestion.explanation) {
                message += "\n\n" + currentQuestion.explanation;
            }
            alert(message);
        } else {
            const correctAnswer = getDisplayAnswer(currentQuestion);
            let message = "Incorrect. The correct answer is: " + correctAnswer;
            if (currentQuestion.explanation) {
                message += "\n\n" + currentQuestion.explanation;
            }
            alert(message);
        }

        answerInput.disabled = true;
        submitButton.textContent = "Next Question";
    }

    function showAnswer() {
        const currentQuestion = shuffledQuestions[currentQuestionIndex];
        const correctAnswer = getDisplayAnswer(currentQuestion);
        let message = "The answer is: " + correctAnswer;
        if (currentQuestion.explanation) {
            message += "\n\n" + currentQuestion.explanation;
        }
        alert(message);
    }

    function nextQuestion() {
        currentQuestionIndex++;
        showQuestion();
    }

    function finishQuiz() {
        questionElement.textContent = "Quiz completed!";
        const percentage = Math.round((score / shuffledQuestions.length) * 100);
        let message = `Final Score: ${score}/${shuffledQuestions.length} (${percentage}%)`;
        
        if (percentage >= 80) message += " - Excellent!";
        else if (percentage >= 60) message += " - Good job!";
        else message += " - Keep practicing!";
        
        alert(message);
        
        submitButton.textContent = "Restart Quiz";
        nextButton.style.display = "none";
        answerInput.style.display = "none";
    }

    function restartQuiz() {
        currentQuestionIndex = 0;
        score = 0;
        scoreElement.textContent = score;
        shuffledQuestions = shuffleArray([...questions]);
        nextButton.style.display = "inline-block";
        answerInput.style.display = "block";
        showQuestion();
    }

    // Event listeners
    submitButton.addEventListener("click", function() {
        if (this.textContent === "Next Question") {
            nextQuestion();
        } else if (this.textContent === "Restart Quiz") {
            restartQuiz();
        } else {
            checkAnswer();
        }
    });

    nextButton.addEventListener("click", showAnswer);

    answerInput.addEventListener("keypress", function(event) {
        if (event.key === "Enter" && !answerInput.disabled) {
            if (submitButton.textContent === "Submit Answer") {
                checkAnswer();
            } else if (submitButton.textContent === "Next Question") {
                nextQuestion();
            }
        }
    });
});
</script>
